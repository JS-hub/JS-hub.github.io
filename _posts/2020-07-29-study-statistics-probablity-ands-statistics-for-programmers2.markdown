---  
layout: post  
title: "프로그래머를 위한 확률과 통계 2장"  
subtitle: "statistics"  
categories:  study
tags: statistics 확률 
comments: false  
---  
### 결합 확률과 주변확률 
---
확률 변수   $X, Y$에 대해, $X=a$고 $Y=b$가 될 확률은 $P(X=a, Y=b)$라 한다. 이때 모든 조건이 동시에 성립하는 확률을 결합 확률이라고 부른다. 그리고 $P(X=a)$나 $P(Y=b)$같은 확률을 주변확률 이라고 하며 아래와 같은 관계를 갖는다.

$P(X=a)=\sum_{b}P(X=a, Y=b)$
$P(Y=b)=\sum_{a}P(X=a, Y=b)$

---
### 조건부 확률
---

아래와 같은 표가 있을 때 

|◇J|◇Q|◇K|♡J|
|:---:|:---:|:---:|:---:|
|**♡Q**|**♡K**|**♡1**|**♡2**|
|**♠K**|**♠1**|**♠2**|**♡3**|
|**♠3**|**♠4**|**♠5**|**♠6**|

<br>
숫자카드와 그림카드 그리고 카드의 색에대해 확률을 구해보면 아래와 같다.

||$Y$= 수 카드|$Y$= 그림 카드|
|:---:|:---:|:---:|
|**$X$= 빨강**|**3/16**|**6/16**|
|**$X$ = 검정**|**6/16**|**1/16**|

<br>
$X=$ 빨강인 경우만 볼 때 ('\|'은 'given'이라고 읽습니다.)<br>
$P(Y$=수 카드$|X$= 빨강) = $\frac 1 3$
$P(Y$=그림 카드$|X$= 빨강) = $\frac 2 3$<br>

$X$ = 빨강이라는 조건에서 $Y$ = 수 카드일 조건부 확률이 $\frac 1 3$,  $Y$ = 그림 카드일 조건부 확률이 $\frac 2 3$다.
이를 $X$ = 빨강이라는 조건에서  $Y$의 조건부분포라한다.
<br>
조건부 확률을 일반적으로 쓰면 
$P(Y=b|X=a) = \frac {P(X=a, Y=b)} {P(X=a)}$ 이며 $\sum_{b}P(Y=b|X=a)$의 값은 항상 1이다.
조건부 확률의 식에서 $P(X=a, Y=b)$를 다시 써보면
$P(X=a, Y=b)=P(Y=b|X=a)P(X=a)$ 위 식이 성립함을 알 수 있다.

---
### 세 개 이상의 확률변수
---

세 개 이상의 확률변수에 대해서 다음과 같이 조건부 확률을 정의한다.
- $Y =b, Z=c$일 때 $X=a$가 되는 조건부 확률
$P(X=a|Y =b, Z=c) = \frac {P(X=a, Y=b, Z=c)} {P(Y=b, Z=c)}$ 
-  $Z=c$일 때$Y =b, X=a$일 조건부 확률
$P(X=a, Y =b|Z=c) = \frac {P(X=a, Y=b, Z=c)} {P(Z=c)}$ 
-  $Z=c, W=d$일 때$Y =b, X=a$일 조건부 확률
$P(X=a, Y =b|Z=c, W=d) = \frac {P(X=a, Y=b, Z=c)} {P(Z=c, W=d)}$

일반적으로 $P(X=a, Y=b, Z=c)$는 다음과 같이 분해할 수 있다.
$P(X=a, Y=b, Z=c)=P(X=a| Y =b, Z=c)P(Y=b, Z=c) =P(X=a|Y =b, Z=c)P(Y=b|Z=c) P(Z=c)$

---
### 예제 : 몬티홀 문제에서의 조건부 확률
---

몬티홀 문제는 다음과 같습니다.
>세 개의 문 중에 하나를 선택하여 문 뒤에 있는 선물을 가질 수 있는 게임쇼에 참가했다. 한 문 뒤에는 자동차가 있고, 나머지 두 문 뒤에는 염소가 있다. 이때 어떤 사람이 예를 들어 A번 문을 선택했을 때, 게임쇼 진행자는 C번 문을 열어 문뒤에 염소가 있음을 보여주면서 A번 대신 B번을 선택하겠냐고 물었다. 참가자가 자동차를 가지려할 때 원래 선택했던 번호를 바꾸는 것이 유리할까?

<p style="text-align: center;" >
<img src = "https://JS-hub.github.io\assets\img\study\Monty_Hall.jfif" >
</p>

<br> $X$를 정답문,  $Y$를 내가 선택하는 문,  $Z$를 진행자가 열어 보이는 문으로 합니다.
$P(X=A|Y=A, Z=C)$라 할 때 그 답은 다음과 같이 구합니다.<br>
$P(X=A|Y=A, Z=C)$
$=\frac {P(X=A,Y=A, Z=C)} {P(Y=A, Z=C)}$
$=\frac {P(X=A,Y=A, Z=C)} {P(X=A,Y=A, Z=C)+P(X=B,Y=A, Z=C)+P(X=C,Y=A, Z=C)}$ <br>
이 안에서 나오는 결합 확률은 게임의 룰에 따라 다음과 같이 계산한다.
처음에 자동차가 놓일 확률은 동일하게 $\frac 1 3$로 같다.<br>
$P(X=A)=P(X=B)=P(X=C))=\frac 1 3$<br>
$Y$도 $X$와 무관하게 같다.<br>
$P(Y=A|X=A)=P(Y=A|X=B)=P(Y=A|X=C))=\frac 1 3$<br>
그리고 진행자가 C를 열어 보이는 조건부 확률은 다음과 같다.<br>
$P(Z=C|X=C, Y=A) =0 $
$P(Z=C|X=B, Y=A) = 1  $
$P(Z=C|X=A, Y=A) =\frac 1 2 $<br>

위의 식을 정리하면<br>
$P(X=A,Y=A, Z=C) = (Z=C|X=A, Y=A)(Y=A|X=A)(X=A) =\frac 1 2 \times\frac 1 3\times \frac 1 3=\frac 1 {18}$<br>
$P(X=B,Y=A, Z=C) = (Z=C|X=B, Y=A)(Y=A|X=B)(X=B) =1 \times\frac 1 3\times \frac 1 3=\frac 1 {9}$<br>
$P(X=C,Y=A, Z=C) = (Z=C|X=C, Y=A)(Y=A|X=C)(X=C) = 0 \times\frac 1 3\times \frac 1 3=0$<br>

$P(X=A|Y=A, Z=C) =\frac {\frac 1 {18}}{\frac 1 {18}+\frac 1 {9}} = \frac 1 3 $<br>
이것이 도전자가 원래 선택했던 번호를 택할 때 정답확률이고 규칙에 의해 $P(X=C|Y=A, Z=C)$는 0이되기 때문에 $P(X=B|Y=A, Z=C) = \frac 2 3$가 됩니다.<br>
따라서 문을 다시 선택하면 $\frac 2 3$의 확률로 정답입니다. 

---
### 베이즈 공식
---

조건부 확률의 응용으로 원인 $X$를 직접적으로 측정할 수 없을 때 거기서 일어나는 결과 $Y$를 보고 원인 $X$를 추측하는 것에 사용합니다.<br>

$P(X = A)$　 원인이  A인확률<br>
$P(Y=B|X = A)$　 원인이  A였을 때, 결과가  B인 조건부 확률의 목록에서<br>
$P(X = A|Y=B)$　  결과가  B였을 때 원인이  A인 조건부 확률을 구하는 것이 목표입니다.<br>


$P(X = A|Y=B)$
$=\frac {P(X = A,Y=B)}{P(Y=B)}$<br>
$=\frac {P(X = A,Y=B}{P(X =  C, Y=B)+P(X = A, Y=B)+...+P(X =  D, Y=B)}$<br>
$= \frac {P(Y=B|X = A)P(X = A)} {P(Y=B|X =  C)P(X =  C)+P(Y=B|X = A)P(X = A) + ... + P(Y=B|X = D)P(X = D)}$<br>

$P(X = A|Y=B)$　
$= \frac {P(Y=B|X = A)P(X = A)} {P(Y=B|X =  C)P(X =  C)+P(Y=B|X = A)P(X = A) + ... + P(Y=B|X = D)P(X = D)}$

<br>
위의 식을 베이즈 공식이라고 하며 결과로부터 원인을 구하는 방법입니다. ...에는 $X$가 취할 수 있는 모든 값을 더합니다.

---
### 독립성
---

$P(AA|BB) = P(AA|BB$이　아니다$)$
위와 같은 식이 성립할 때 ○○과 ▲▲는 **독립**이라고 합니다. 또 독립이 아닐 때는 **종속**이다라고 말하거나 독립이 아니다 라고 말하기도 합니다.<br>

#### 독립성 바꿔 말하기
다음은 독립을 다양하게 말을 바꿔 정의한 것입니다.<br>
(가)　○○과 ▲▲는 독립 <br>
(나)　조건부 확률이 조건에 따라 다르지 않다. 
　　　$P(▲▲|○○) = P(▲▲|○○$이아님$)$
 <br>
(다)　조건을 달든 달지 않든 확률이 변하지 않는다.  <br>
　　　$P(▲▲|○○) = P(▲▲)$  <br>
(라)　결합 확률의 비율이 같다.  <br>
　　　$P(○○,▲▲):P(○○,▲▲$이 아님$)= P(○○,▲▲$이 아님$) :P(○○$이 아님$,▲▲$이 아님$)$  <br>
(마)　결합확률이 주변 확률의 곱  <br>
　　　$P(○○,▲▲)= P(○○)P(▲▲)$ <br>

#### 세 개 이상의 독립성 
위에서는 두 확률변수 X와 Y의 독립성을 설명 했고 더 많은 확률 변수의 독립성으로 정의를 확장한다.<br>

다음식은 일반적으로 성립한다.
$P(○○,△△,□□)= P(○○,|△△,□□)P(△△|□□)P(□□)$ 
$P(○○,△△)= P(○○|△△)P(△△)$ 
$P(△△,□□)= P(△△|□□)P(□□)$ 
$P(□□,○○)= P(□□|○○)P(○○)$ 

세 변수가 독립일 때 아래와 같이 쓸 수 있다.
$P(○○,△△,□□)= P(○○)P(△△)P(□□)$ 
$P(○○,△△)= P(○○)P(△△)$ 
$P(△△,□□)= P(△△)P(□□)$ 
$P(□□,○○)= P(□□)P(○○)$ 
